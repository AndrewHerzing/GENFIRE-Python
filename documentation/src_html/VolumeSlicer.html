<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>..//GENFIRE/gui/VolumeSlicer</title>
  <meta name="description" content="GENFIRE Documentation">
  <meta name="author" content="Alan (AJ) Pryor, Jr.">  <link rel="stylesheet" href="css/styles.css?v=1.0">
  <link rel="stylesheet" type="text/css" href="main.css">
</head>
<body>
<code><font color="orange">import </font>VolumeSlicer_MainWindow<br><font color="orange">from </font>PyQt4 <font color="orange">import </font>QtCore, QtGui<br><font color="orange">import </font>matplotlib<br>matplotlib.use("Qt4Agg")<br><font color="orange">import </font>matplotlib.pyplot as plt<br><font color="orange">from </font>matplotlib.backends.backend_qt4agg <font color="orange">import </font>FigureCanvasQTAgg as FigureCanvas<br><font color="orange">from </font>matplotlib.backends.backend_qt4agg <font color="orange">import </font>NavigationToolbar2QT as NavigationToolbar<br><font color="orange">import </font>numpy as np<br><font color="orange">from </font>functools <font color="orange">import </font>partial<br><br><font color="orange">class </font>VolumeSlicer(QtGui.QMainWindow):<br>    <font color="orange">def </font>__init__(self, volume):<br>        super(VolumeSlicer, self).__init__()<br>        self.volume = volume<br>        self.ui = VolumeSlicer_MainWindow.Ui_VolumeSlicer()<br>        self.ui.setupUi(self)<br>        self.ui.checkBox_lockcmap.toggled.connect(self.toggleLockCmap)<br>        self.lockColormap = False<br>        self.ui.checkBox_lockcmap.setChecked(False)<br><br>        self.fig1 = plt.figure()<br>        self.fig2 = plt.figure()<br>        self.fig3 = plt.figure()<br><br>        self.canvas1 = FigureCanvas(self.fig1)<br>        self.canvas2 = FigureCanvas(self.fig2)<br>        self.canvas3 = FigureCanvas(self.fig3)<br><br>        self.slice1 = self.fig1.add_subplot(111)<br>        self.slice2 = self.fig2.add_subplot(111)<br>        self.slice3 = self.fig3.add_subplot(111)<br><br>        self.slice1.hold(False)<br>        self.slice2.hold(False)<br>        self.slice3.hold(False)<br><br>        self.navigationToolbar1 = NavigationToolbar(self.canvas1, self)<br>        self.navigationToolbar2 = NavigationToolbar(self.canvas2, self)<br>        self.navigationToolbar3 = NavigationToolbar(self.canvas3, self)<br><br>        self.ui.vt_lyt_fig1.addWidget(self.navigationToolbar1)<br>        self.ui.vt_lyt_fig1.addWidget(self.canvas1)<br>        self.ui.vt_lyt_fig2.addWidget(self.navigationToolbar2)<br>        self.ui.vt_lyt_fig2.addWidget(self.canvas2)<br>        self.ui.vt_lyt_fig3.addWidget(self.navigationToolbar3)<br>        self.ui.vt_lyt_fig3.addWidget(self.canvas3)<br><br>        dimx, dimy, dimz = np.shape(volume)<br>        ncx,  ncy,  ncz  = dimx//2., dimy//2, dimz//2<br>        ncx,  ncy,  ncz  = int(ncx), int(ncy), int(ncz)<br><br>        self.ui.scrlbr_fig1.valueChanged.connect(partial(self.setTextFromSlider,self.ui.lineEdit_scrlbr1))<br>        self.ui.scrlbr_fig2.valueChanged.connect(partial(self.setTextFromSlider,self.ui.lineEdit_scrlbr2))<br>        self.ui.scrlbr_fig3.valueChanged.connect(partial(self.setTextFromSlider,self.ui.lineEdit_scrlbr3))<br><br>        self.ui.scrlbr_fig1.setValue(ncx)<br>        self.ui.scrlbr_fig1.setMinimum(0)<br>        self.ui.scrlbr_fig1.setMaximum(dimx-1)<br><br>        self.ui.scrlbr_fig2.setValue(ncy)<br>        self.ui.scrlbr_fig2.setMinimum(0)<br>        self.ui.scrlbr_fig2.setMaximum(dimy-1)<br><br>        self.ui.scrlbr_fig3.setValue(ncz)<br>        self.ui.scrlbr_fig3.setMinimum(0)<br>        self.ui.scrlbr_fig3.setMaximum(dimz-1)<br><br>        self.ui.lineEdit_scrlbr1.textChanged.connect(partial(self.setSliderFromText,self.ui.scrlbr_fig1))<br>        self.ui.lineEdit_scrlbr2.textChanged.connect(partial(self.setSliderFromText,self.ui.scrlbr_fig2))<br>        self.ui.lineEdit_scrlbr3.textChanged.connect(partial(self.setSliderFromText,self.ui.scrlbr_fig3))<br><br>        self.currentSliceX = ncx<br>        self.currentSliceY = ncy<br>        self.currentSliceZ = ncz<br>        self.updateAll()<br><br>        self.ui.scrlbr_fig1.valueChanged[int].connect(self.updateSliceX)<br>        self.ui.scrlbr_fig2.valueChanged[int].connect(self.updateSliceY)<br>        self.ui.scrlbr_fig3.valueChanged[int].connect(self.updateSliceZ)<br><br>        self.clim1 = plt.getp(plt.getp(self.slice1,'images')[0],'clim')<br>        self.clim2 = plt.getp(plt.getp(self.slice2,'images')[0],'clim')<br>        self.clim3 = plt.getp(plt.getp(self.slice3,'images')[0],'clim')<br><br>        self.lockColormap = True<br>        self.ui.checkBox_lockcmap.setChecked(True)<br><br><br>    <font color="orange">def </font>updateSliceX(self, nx):<br>        self.slice1.imshow(np.squeeze(self.volume[nx, :, :]))<br>        <font color="orange">if </font>self.lockColormap:<br>            plt.setp(plt.getp(self.slice1,'images')[0],'clim',self.clim1)<br>        self.canvas1.draw()<br><br>    <font color="orange">def </font>updateSliceY(self, ny):<br>        self.slice2.imshow(np.squeeze(self.volume[:, ny, :]))<br>        <font color="orange">if </font>self.lockColormap:<br>            plt.setp(plt.getp(self.slice2,'images')[0],'clim',self.clim2)<br>        self.canvas2.draw()<br><br>    <font color="orange">def </font>updateSliceZ(self, nz):<br>        self.slice3.imshow(np.squeeze(self.volume[:, :, nz]))<br>        <font color="orange">if </font>self.lockColormap:<br>            plt.setp(plt.getp(self.slice3,'images')[0],'clim',self.clim3)<br>        self.canvas3.draw()<br><br>    <font color="orange">def </font>updateAll(self):<br>        self.updateSliceX(self.currentSliceX)<br>        self.updateSliceY(self.currentSliceY)<br>        self.updateSliceZ(self.currentSliceZ)<br><br>    <font color="orange">def </font>toggleLockCmap(self):<br>        <font color="orange">if </font>self.ui.checkBox_lockcmap.isChecked():<br>            self.lockColormap = True<br>        else:<br>            self.lockColormap = False<br><br>    <font color="orange">def </font>setSliderFromText(self, slider, text):<br>        slider.setValue(text.toInt()[0])<br><br>    <font color="orange">def </font>setTextFromSlider(self, lineedit, value):<br>        lineedit.setText(QtCore.QString(str(value)))</code></body>
    </html>