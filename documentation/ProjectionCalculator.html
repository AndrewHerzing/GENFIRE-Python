<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>../ProjectionCalculator</title>
  <meta name="description" content="GENFIRE Documentation">
  <meta name="author" content="Alan (AJ) Pryor, Jr.">  <link rel="stylesheet" href="css/styles.css?v=1.0">
  <link rel="stylesheet" type="text/css" href="main.css">
</head>
<body>
<code><font color="green">from</font> PyQt4 <font color="green">import</font> QtCore, QtGui<br><font color="green">import</font> os<br><font color="green">import</font> misc<br><font color="green">import</font> pyfftw<br><font color="green">import</font> numpy as np<br><font color="green">import</font> matplotlib.pyplot as plt<br><font color="green">from</font> matplotlib.backends.backend_qt4agg <font color="green">import</font> FigureCanvasQTAgg as FigureCanvas<br><font color="green">from</font> matplotlib.backends.backend_qt4agg <font color="green">import</font> NavigationToolbar2QT as NavigationToolbar<br><font color="green">import</font> ProjectionCalculator_ui<br><font color="green">import</font> scipy.io as io<br># <font color="green">import</font> GENFIRE_GUI<br># <font color="green">import</font> GENFIRE<br># <font color="green">import</font> GENFIRE_main<br><br><br><font color="green">class</font> ProjectionCalculator(QtGui.QMainWindow): #QDialog?<br>    <font color="green">def</font> __init__(<font color="green">self</font>, parent=None):<br>        super(ProjectionCalculator, <font color="green">self</font>).__init__()<br>        <font color="green">self</font>.ui = ProjectionCalculator_ui.Ui_ProjectionCalculator()<br>        <font color="green">self</font>.ui.setupUi(<font color="green">self</font>)<br>        <font color="green">self</font>.calculationParameters = ProjectionCalculationParameters()<br><br>        <font color="green">self</font>.ui.lineEdit_outputFilename.setText(QtCore.QString(os.getcwd()))<br>        <font color="green">self</font>.ui.lineEdit_modelFile.setText(QtCore.QString(os.getcwd()))<br>        <font color="green">self</font>.ui.lineEdit_angleFile.setText(QtCore.QString(os.getcwd()))<br>        <font color="green">self</font>.ui.lineEdit_modelFile.textEdited.connect(<font color="green">self</font>.setModelFilename_<font color="green">from</font>LineEdit)<br>        <font color="green">self</font>.ui.lineEdit_angleFile.textEdited.connect(<font color="green">self</font>.setAngleFilename_<font color="green">from</font>LineEdit)<br><br>        ## Push Buttons<br>        <font color="green">self</font>.ui.btn_selectAngleFile.clicked.connect(<font color="green">self</font>.selectAngleFile)<br>        <font color="green">self</font>.ui.btn_selectModel.clicked.connect(<font color="green">self</font>.selectModelFile)<br>        <font color="green">self</font>.ui.btn_outputDirectory.clicked.connect(<font color="green">self</font>.selectOutputDirectory)<br>        <font color="green">self</font>.ui.btn_refresh.clicked.connect(<font color="green">self</font>.refreshModel)<br><br>        ## Sliders<br>        <font color="green">self</font>.ui.verticalSlider_phi.setValue(0)<br>        <font color="green">self</font>.ui.verticalSlider_phi.setMinimum(0)<br>        <font color="green">self</font>.ui.verticalSlider_phi.setMaximum(3600)<br>        # <font color="green">self</font>.ui.verticalSlider_phi.setSingleStep(1)<br>        <font color="green">self</font>.ui.verticalSlider_phi.valueChanged.connect(<font color="green">self</font>.setPhiLineEditValue)<br>        # <font color="green">self</font>.ui.verticalSlider_phi.sliderReleased.connect(<font color="green">self</font>.setPhiLineEditValue)<br><br>        <font color="green">self</font>.ui.verticalSlider_theta.setValue(0)<br>        <font color="green">self</font>.ui.verticalSlider_theta.setMinimum(0)<br>        <font color="green">self</font>.ui.verticalSlider_theta.setMaximum(3600)<br>        # <font color="green">self</font>.ui.verticalSlider_theta.setSingleStep(1)<br>        <font color="green">self</font>.ui.verticalSlider_theta.valueChanged.connect(<font color="green">self</font>.setThetaLineEditValue)<br><br>        <font color="green">self</font>.ui.verticalSlider_psi.setValue(0)<br>        <font color="green">self</font>.ui.verticalSlider_psi.setMinimum(0)<br>        <font color="green">self</font>.ui.verticalSlider_psi.setMaximum(3600)<br>        # <font color="green">self</font>.ui.verticalSlider_psi.setSingleStep(1)<br>        <font color="green">self</font>.ui.verticalSlider_psi.valueChanged.connect(<font color="green">self</font>.setPsiLineEditValue)<br><br>        <font color="green">self</font>.ui.checkBox_displayFigure.setEnabled(False)<br>        # <font color="green">self</font>.ui.checkBox_displayProjections.toggled.connect(<font color="green">self</font>.toggleDisplayProjections)<br>        # <font color="green">self</font>.ui.checkBox_saveProjections.toggled.connect(<font color="green">self</font>.toggleSaveProjections)<br><br>        <font color="green">self</font>.ui.lineEdit_outputFilename.textEdited.connect(<font color="green">self</font>.setOutputFilename)<br>        <font color="green">self</font>.ui.lineEdit_phi.setText(QtCore.QString('0'))<br>        <font color="green">self</font>.ui.lineEdit_theta.setText(QtCore.QString('0'))<br>        <font color="green">self</font>.ui.lineEdit_psi.setText(QtCore.QString('0'))<br>        <font color="green">self</font>.ui.lineEdit_phi.editingFinished.connect(<font color="green">self</font>.setPhiSliderValue)<br>        <font color="green">self</font>.ui.lineEdit_theta.editingFinished.connect(<font color="green">self</font>.setThetaSliderValue)<br>        <font color="green">self</font>.ui.lineEdit_psi.editingFinished.connect(<font color="green">self</font>.setPsiSliderValue)<br><br>        # <font color="green">self</font>.ui.lineEdit_outputFilename.textEdited<br>        <font color="green">self</font>.ui.lineEdit_outputFilename.setText(QtCore.QString(os.getcwd()))<br><br>        <font color="green">self</font>.ui.btn_go.clicked.connect(<font color="green">self</font>.calculateProjections)<br><br>        <font color="green">self</font>.ui.checkBox_displayFigure.toggled.connect(<font color="green">self</font>.toggleDisplayFigure)<br><br>        <font color="green">self</font>.figure = plt.figure(1)<br>        <font color="green">self</font>.canvas = FigureCanvas(<font color="green">self</font>.figure)<br>        <font color="green">self</font>.navigationToolbar = NavigationToolbar(<font color="green">self</font>.canvas, <font color="green">self</font>)<br>        <font color="green">self</font>.ui.verticalLayout_figure.addWidget(<font color="green">self</font>.navigationToolbar)<br>        <font color="green">self</font>.ui.verticalLayout_figure.addWidget(<font color="green">self</font>.canvas)<br><br><br>    <font color="green">def</font> calculateProjections(<font color="green">self</font>):<br>        <font color="green">import</font> scipy.io as io<br>        <font color="green">self</font>.calculationParameters.modelFilename = unicode(<font color="green">self</font>.calculationParameters.modelFilename.toUtf8(), encoding='UTF-8')<br>        <font color="green">if</font> not <font color="green">self</font>.calculationParameters.modelLoadedFlag:<br><br>            <font color="green">self</font>.GENFIRE_load(<font color="green">self</font>.calculationParameters.modelFilename)<br>            <font color="green">self</font>.oversamplingRatio = 3<br>            <font color="green">self</font>.dims = np.shape(<font color="green">self</font>.model)<br>            paddedDim = <font color="green">self</font>.dims[0] * <font color="green">self</font>.oversamplingRatio<br>            padding = int((paddedDim-<font color="green">self</font>.dims[0])/2)<br>            <font color="green">self</font>.model = np.pad(<font color="green">self</font>.model,((padding,padding),(padding,padding),(padding,padding)),'constant')<br>            <font color="green">self</font>.model = pyfftw.interfaces.numpy_fft.fftsh<font color="green">if</font>t(pyfftw.interfaces.numpy_fft.fftn(pyfftw.interfaces.numpy_fft.<font color="green">if</font>ftsh<font color="green">if</font>t((<font color="green">self</font>.model))))<br>        <font color="green">self</font>.ncOut = np.shape(<font color="green">self</font>.model)[0]//2<br><br><br>        <font color="green">if</font> <font color="green">self</font>.calculationParameters.angleFileProvided:<br>            print type(<font color="green">self</font>.calculationParameters.angleFilename)<br>            <font color="green">self</font>.calculationParameters.angleFilename = unicode(<font color="green">self</font>.calculationParameters.angleFilename.toUtf8(), encoding='UTF-8')<br>            <font color="green">self</font>.calculationParameters.outputBaseFilename = unicode(<font color="green">self</font>.calculationParameters.outputBaseFilename.toUtf8(), encoding='UTF-8')<br>            angles = np.loadtxt(<font color="green">self</font>.calculationParameters.angleFilename)<br>            print np.shape(angles)<br>            phi = angles[:, 0]<br>            theta = angles[:, 1]<br>            psi = angles[:, 2]<br>            filename = <font color="green">self</font>.calculationParameters.outputBaseFilename +'.npy'<br>            projections = np.zeros((<font color="green">self</font>.dims[0],<font color="green">self</font>.dims[1],np.size(phi)),dtype=float)<br>            <font color="green">for</font> projNum in range(0,np.size(phi)):<br>                # pj = misc.calculateProjection_interp(<font color="green">self</font>.model, phi[projNum], theta[projNum], psi[projNum])[<font color="green">self</font>.ncOut-<font color="green">self</font>.dims[0]/2:<font color="green">self</font>.ncOut+<font color="green">self</font>.dims[0]/2, <font color="green">self</font>.ncOut-<font color="green">self</font>.dims[1]/2:<font color="green">self</font>.ncOut+<font color="green">self</font>.dims[1]/2]<br>                projections[:, :, projNum] = misc.calculateProjection_interp(<font color="green">self</font>.model, phi[projNum], theta[projNum], psi[projNum])[<font color="green">self</font>.ncOut-<font color="green">self</font>.dims[0]/2:<font color="green">self</font>.ncOut+<font color="green">self</font>.dims[0]/2, <font color="green">self</font>.ncOut-<font color="green">self</font>.dims[1]/2:<font color="green">self</font>.ncOut+<font color="green">self</font>.dims[1]/2]<br><br>                # pj = misc.calculateProjection_interp(model, phi[projNum], theta[projNum], psi[projNum])<br>                    ##display projection<br>                # <font color="green">if</font> <font color="green">self</font>.calculationParameters.outputFilesFlag:<br>                print "pre 1", type(<font color="green">self</font>.calculationParameters.outputBaseFilename)<br><br>            # filename = <font color="green">self</font>.calculationParameters.outputBaseFilename + str(projNum) +'.mat'<br><br>                # print filename<br>                # print "type", type(filename)<br>                # outDict = {'pj': pj}<br>                # io.savemat(filename,outDict)<br>            np.save(filename,projections)<br>        else:<br>            pj = misc.calculateProjection_interp(<font color="green">self</font>.model, <font color="green">self</font>.calculationParameters.phi,<font color="green">self</font>.calculationParameters.theta,<font color="green">self</font>.calculationParameters.psi)[<font color="green">self</font>.ncOut-<font color="green">self</font>.dims[0]/2:<font color="green">self</font>.ncOut+<font color="green">self</font>.dims[0]/2, <font color="green">self</font>.ncOut-<font color="green">self</font>.dims[1]/2:<font color="green">self</font>.ncOut+<font color="green">self</font>.dims[1]/2]<br>            print "pre", type(<font color="green">self</font>.calculationParameters.outputBaseFilename)<br>            filename = <font color="green">self</font>.calculationParameters.outputBaseFilename +'TEMPprojectionName.mat'<br>            print filename<br>            print type(filename)<br>            outDict = {'pj': pj}<br>            io.savemat(filename,outDict)<br>            <font color="green">self</font>.showProjection(pj)<br><br><br>    <font color="green">def</font> refreshModel(<font color="green">self</font>):<br>        <font color="green">self</font>.ui.checkBox_displayFigure.click()<br>        <font color="green">self</font>.ui.checkBox_displayFigure.click()<br><br>    <font color="green">def</font> toggleDisplayFigure(<font color="green">self</font>):<br>        print ("%%%$$$$#### <font color="green">self</font>.calculationParameters.displayProjectionsFlag =  ", <font color="green">self</font>.calculationParameters.displayProjectionsFlag)<br>        <font color="green">if</font> not <font color="green">self</font>.calculationParameters.displayProjectionsFlag:<br>           <font color="green">self</font>.calculationParameters.displayProjectionsFlag = True<br>           <font color="green">if</font> <font color="green">self</font>.calculationParameters.modelFilenameProvided:<br>                <font color="green">import</font> scipy.io as io<br>                modelFilename = unicode(<font color="green">self</font>.calculationParameters.modelFilename.toUtf8(), encoding='UTF-8')<br>                <font color="green">self</font>.GENFIRE_load(modelFilename)<br>                <font color="green">self</font>.oversamplingRatio = 3<br>                print np.shape(<font color="green">self</font>.model)<br>                <font color="green">self</font>.dims = np.shape(<font color="green">self</font>.model)<br>                <font color="green">self</font>.paddedDim = <font color="green">self</font>.dims[0] * <font color="green">self</font>.oversamplingRatio<br>                padding = int((<font color="green">self</font>.paddedDim-<font color="green">self</font>.dims[0])/2)<br>                <font color="green">self</font>.model = np.pad(<font color="green">self</font>.model,((padding,padding),(padding,padding),(padding,padding)),'constant')<br>                <font color="green">self</font>.model = pyfftw.interfaces.numpy_fft.fftsh<font color="green">if</font>t(pyfftw.interfaces.numpy_fft.fftn(pyfftw.interfaces.numpy_fft.<font color="green">if</font>ftsh<font color="green">if</font>t((<font color="green">self</font>.model))))<br>                # global ncOut<br>                <font color="green">self</font>.ncOut = np.shape(<font color="green">self</font>.model)[0]//2<br>                pj = misc.calculateProjection_interp(<font color="green">self</font>.model, <font color="green">self</font>.calculationParameters.phi,<font color="green">self</font>.calculationParameters.theta,<font color="green">self</font>.calculationParameters.psi)[<font color="green">self</font>.ncOut-<font color="green">self</font>.dims[0]/2:<font color="green">self</font>.ncOut+<font color="green">self</font>.dims[0]/2, <font color="green">self</font>.ncOut-<font color="green">self</font>.dims[1]/2:<font color="green">self</font>.ncOut+<font color="green">self</font>.dims[1]/2]<br>                <font color="green">self</font>.showProjection(pj)<br>                <font color="green">self</font>.calculationParameters.modelLoadedFlag = True<br>        else:<br>            <font color="green">self</font>.calculationParameters.displayProjectionsFlag = False<br>            <font color="green">self</font>.clearFigure()<br><br><br>    <font color="green">def</font> updateFigure(<font color="green">self</font>):<br>        pj = misc.calculateProjection_interp(<font color="green">self</font>.model, <font color="green">self</font>.calculationParameters.phi,<font color="green">self</font>.calculationParameters.theta,<font color="green">self</font>.calculationParameters.psi)[<font color="green">self</font>.ncOut-<font color="green">self</font>.dims[0]/2:<font color="green">self</font>.ncOut+<font color="green">self</font>.dims[0]/2, <font color="green">self</font>.ncOut-<font color="green">self</font>.dims[1]/2:<font color="green">self</font>.ncOut+<font color="green">self</font>.dims[1]/2]<br>        ## these lines are the same as showProjection, but I copied them to make it inline so it runs faster<br>        myFig = <font color="green">self</font>.figure.add_subplot(111)<br>        myFig.imshow(pj)<br>        myFig.axes.get_xaxis().set_visible(False)<br>        myFig.axes.get_yaxis().set_visible(False)<br>        # <font color="green">self</font>.figure.imshow(pj)<br>        <font color="green">self</font>.canvas.draw()<br>        # <font color="green">self</font>.showProjection(pj)<br><br><br>    <font color="green">def</font> showProjection(<font color="green">self</font>, pj):<br>        myFig = <font color="green">self</font>.figure.add_subplot(111)<br>        myFig.imshow(pj)<br>        myFig.axes.get_xaxis().set_visible(False)<br>        myFig.axes.get_yaxis().set_visible(False)<br>        # <font color="green">self</font>.figure.imshow(pj)<br>        <font color="green">self</font>.canvas.draw()<br><br>    <font color="green">def</font> clearFigure(<font color="green">self</font>):<br>        # myFig = <font color="green">self</font>.figure.add_subplot(111)<br>        # myFig.axes.get_xaxis().set_visible(False)<br>        # myFig.axes.get_yaxis().set_visible(False)<br>        <font color="green">self</font>.figure.clf()<br>        <font color="green">self</font>.canvas.draw()<br><br>    <font color="green">def</font> setPhiSliderValue(<font color="green">self</font>):<br>        value = <font color="green">self</font>.ui.lineEdit_phi.text().toFloat()[0]<br>        value = int(value * 10)<br>        <font color="green">self</font>.ui.verticalSlider_phi.setValue(value)<br><br>    <font color="green">def</font> setThetaSliderValue(<font color="green">self</font>):<br>        value = <font color="green">self</font>.ui.lineEdit_theta.text().toFloat()[0]<br>        value = int(value * 10)<br>        <font color="green">self</font>.ui.verticalSlider_theta.setValue(value)<br><br>    <font color="green">def</font> setPsiSliderValue(<font color="green">self</font>):<br>        value = <font color="green">self</font>.ui.lineEdit_psi.text().toFloat()[0]<br>        value = int(value * 10)<br>        <font color="green">self</font>.ui.verticalSlider_psi.setValue(value)<br><br><br>    <font color="green">def</font> setPhiLineEditValue(<font color="green">self</font>, value):<br>        <font color="green">self</font>.ui.lineEdit_phi.setText(QtCore.QString.number(float(value)/10))<br>        <font color="green">self</font>.calculationParameters.phi = float(value)/10<br>        <font color="green">if</font> <font color="green">self</font>.calculationParameters.displayProjectionsFlag:<br>            <font color="green">self</font>.updateFigure()<br><br>    <font color="green">def</font> setThetaLineEditValue(<font color="green">self</font>, value):<br>        <font color="green">self</font>.ui.lineEdit_theta.setText(QtCore.QString.number(float(value)/10))<br>        <font color="green">self</font>.calculationParameters.theta = float(value)/10<br>        <font color="green">if</font> <font color="green">self</font>.calculationParameters.displayProjectionsFlag:<br>            <font color="green">self</font>.updateFigure()<br><br>    <font color="green">def</font> setPsiLineEditValue(<font color="green">self</font>, value):<br>        <font color="green">self</font>.ui.lineEdit_psi.setText(QtCore.QString.number(float(value)/10))<br>        <font color="green">self</font>.calculationParameters.psi = float(value)/10<br>        <font color="green">if</font> <font color="green">self</font>.calculationParameters.displayProjectionsFlag:<br>            <font color="green">self</font>.updateFigure()<br><br>    <font color="green">def</font> setNumberOfProjections(<font color="green">self</font>, number):<br>        <font color="green">self</font>.calculationParameters.numberOfProjections = number.toInt()[0]<br><br>    <font color="green">def</font> setPhiStart(<font color="green">self</font>, phiStart):<br>        <font color="green">self</font>.calculationParameters.phiStart = phiStart.toFloat()[0]<br><br>    <font color="green">def</font> setThetaStart(<font color="green">self</font>, thetaStart):<br>        <font color="green">self</font>.calculationParameters.thetaStart = thetaStart.toFloat()[0]<br><br>    <font color="green">def</font> setPsiStart(<font color="green">self</font>, psiStart):<br>        <font color="green">self</font>.calculationParameters.psiStart = psiStart.toFloat()[0]<br><br>    <font color="green">def</font> setPhiStep(<font color="green">self</font>, phiStep):<br>        <font color="green">self</font>.calculationParameters.phiStep = phiStep.toFloat()[0]<br><br>    <font color="green">def</font> setThetaStep(<font color="green">self</font>, thetaStep):<br>        <font color="green">self</font>.calculationParameters.thetaStep = thetaStep.toFloat()[0]<br><br>    <font color="green">def</font> setPsiStep(<font color="green">self</font>, psiStep):<br>        <font color="green">self</font>.calculationParameters.psiStep = psiStep.toFloat()[0]<br><br>    <font color="green">def</font> selectOutputDirectory(<font color="green">self</font>):<br>        dirname = QtGui.QFileDialog.getExistingDirectory(QtGui.QFileDialog(), "Select File Containing Angles",options=QtGui.QFileDialog.ShowDirsOnly)<br>        <font color="green">if</font> dirname:<br>            # <font color="green">self</font>.calculationParameters.outputBaseFilename = dirname<br>            # <font color="green">self</font>.calculationParameters.outputBaseFilename =  unicode(dirname.toUtf8(), encoding='UTF-8')<br>            <font color="green">self</font>.calculationParameters.outputBaseFilename =  dirname<br>            <font color="green">self</font>.ui.lineEdit_outputFilename.setText(QtCore.QString(dirname))<br><br>    <font color="green">def</font> selectAngleFile(<font color="green">self</font>):<br>        filename = QtGui.QFileDialog.getOpenFileName(QtGui.QFileDialog(), "Select File Containing Angles",filter="txt files (*.txt);;All Files (*)")<br>        <font color="green">if</font> filename:<br>            <font color="green">self</font>.calculationParameters.angleFilename = filename<br>            <font color="green">self</font>.calculationParameters.angleFileProvided = True<br>            <font color="green">self</font>.ui.lineEdit_angleFile.setText(QtCore.QString(filename))<br>            # print "angle File, ", <font color="green">self</font>.calculationParameters.angleFilename<br><br>    <font color="green">def</font> setAngleFilename_<font color="green">from</font>LineEdit(<font color="green">self</font>):<br>        filename = <font color="green">self</font>.ui.lineEdit_angleFile.text()<br>        <font color="green">if</font> os.path.isfile(unicode(filename.toUtf8(),encoding='UTF-8')):<br>            <font color="green">self</font>.calculationParameters.angleFilename = filename<br>            <font color="green">self</font>.calculationParameters.angleFileProvided = True<br>            <font color="green">self</font>.ui.lineEdit_angleFile.setText(QtCore.QString(filename))<br><br>    <font color="green">def</font> setModelFilename_<font color="green">from</font>LineEdit(<font color="green">self</font>):<br>        filename = <font color="green">self</font>.ui.lineEdit_modelFile.text()<br>        # print unicode(filename.toUtf8(),encoding='UTF-8')<br>        # print os.path.isfile(unicode(filename.toUtf8(),encoding='UTF-8'))<br>        <font color="green">if</font> os.path.isfile(unicode(filename.toUtf8(),encoding='UTF-8')):<br>            # <font color="green">self</font>.modelLoadedFlag = False<br>            <font color="green">self</font>.GENFIRE_load(unicode(filename.toUtf8(),encoding='UTF-8'))<br>            # print "going"<br>            # <font color="green">self</font>.setModelFilename(filename)<br>            <font color="green">self</font>.calculationParameters.modelFilename = filename<br>            # <font color="green">self</font>.ui.lineEdit_modelFile.setText(QtCore.QString(filename))<br>            <font color="green">self</font>.calculationParameters.modelFilenameProvided = True<br>            <font color="green">self</font>.ui.checkBox_displayFigure.setEnabled(True)<br><br>    <font color="green">def</font> setModelFilename(<font color="green">self</font>, filename):<br>        print "test"<br>        <font color="green">self</font>.calculationParameters.modelFilename = filename<br>        <font color="green">self</font>.ui.lineEdit_modelFile.setText(QtCore.QString(filename))<br>        <font color="green">self</font>.calculationParameters.modelFilenameProvided = True<br>        <font color="green">self</font>.ui.checkBox_displayFigure.setEnabled(True)<br><br>    <font color="green">def</font> selectModelFile(<font color="green">self</font>):<br>        filename = QtGui.QFileDialog.getOpenFileName(QtGui.QFileDialog(), "Select File Containing Model",filter="MATLAB files (*.mat);;TIFF images (*.t<font color="green">if</font> *.t<font color="green">if</font>f);;MRC (*.mrc);;All Files (*)")<br>        print "myfilename",  filename<br><br>        <font color="green">if</font> os.path.isfile(unicode(filename.toUtf8(),encoding='UTF-8')):<br>            # print "it is a file"<br>            <font color="green">self</font>.setModelFilename(filename)<br>            # <font color="green">self</font>.GENFIRE_load(filename)<br>            <font color="green">self</font>.GENFIRE_load(unicode(filename.toUtf8(),encoding='UTF-8'))<br>            # <font color="green">self</font>.modelLoadedFlag = False<br>            # <font color="green">self</font>.model = <font color="green">self</font>.loadModel(filename)<br>            # <font color="green">self</font>.calculationParameters.modelFilename = filename<br>            # <font color="green">self</font>.ui.lineEdit_modelFile.setText(QtCore.QString(filename))<br>            # <font color="green">self</font>.calculationParameters.modelFilenameProvided = True<br>            # <font color="green">self</font>.ui.checkBox_displayFigure.setEnabled(True)<br><br>    #<br>    # <font color="green">def</font> setModelFilename(<font color="green">self</font>, filename):<br>    #     <font color="green">if</font> filename:<br>    #         <font color="green">self</font>.calculationParameters.modelFilename = filename<br>    #         <font color="green">self</font>.calculationParameters.modelNameProvided = True<br><br>    <font color="green">def</font> setAngleFilename(<font color="green">self</font>, filename):<br>        <font color="green">if</font> filename:<br>            <font color="green">self</font>.calculationParameters.angleFilename = filename<br><br>    <font color="green">def</font> toggleDisplayProjections(<font color="green">self</font>):<br>        <font color="green">if</font> <font color="green">self</font>.calculationParameters.displayProjectionsFlag:<br>            <font color="green">self</font>.calculationParameters.displayProjectionsFlag = False<br>        else:<br>            <font color="green">self</font>.calculationParameters.displayProjectionsFlag = True<br><br>    <font color="green">def</font> toggleSaveProjections(<font color="green">self</font>):<br>        print GENFIRE_ProjectionCalculator.calculationParameters.modelFilename<br>        print GENFIRE_ProjectionCalculator.calculationParameters.angleFilename<br>        print GENFIRE_ProjectionCalculator.calculationParameters.outputBaseFilename<br>        print GENFIRE_ProjectionCalculator.calculationParameters.outputFilesFlag<br>        print  GENFIRE_ProjectionCalculator.calculationParameters.displayProjectionsFlag<br>        print GENFIRE_ProjectionCalculator.calculationParameters.phiStart<br>        print GENFIRE_ProjectionCalculator.calculationParameters.thetaStart<br>        print  GENFIRE_ProjectionCalculator.calculationParameters.psiStart<br>        print GENFIRE_ProjectionCalculator.calculationParameters.phiStep<br>        print GENFIRE_ProjectionCalculator.calculationParameters.thetaStep<br>        print GENFIRE_ProjectionCalculator.calculationParameters.psiStep<br>        print GENFIRE_ProjectionCalculator.calculationParameters.numberOfProjections<br><br><br>        <font color="green">if</font> <font color="green">self</font>.calculationParameters.outputFilesFlag:<br>            <font color="green">self</font>.calculationParameters.outputFilesFlag = False<br>        else:<br>            <font color="green">self</font>.calculationParameters.outputFilesFlag = True<br><br>    <font color="green">def</font> setOutputFilename(<font color="green">self</font>, filename):<br>        <font color="green">if</font> filename:<br>            <font color="green">self</font>.calculationParameters.outputBaseFilename = filename<br><br><br>    <font color="green">def</font> GENFIRE_load(<font color="green">self</font>, filename):<br>        print "GENFIRE load file", filename<br>        print type(filename)<br>        <font color="green">self</font>.model = io.loadmat(filename)<br>        <font color="green">self</font>.model = <font color="green">self</font>.model['model']##CHANGE<br>        print np.shape(<font color="green">self</font>.model)<br><br><br><br><font color="green">class</font> ProjectionCalculationParameters:<br>    <font color="green">def</font> __init__(<font color="green">self</font>):<br>        <font color="green">self</font>.modelFilename = QtCore.QString('')<br>        <font color="green">self</font>.angleFilename = QtCore.QString('')<br>        <font color="green">self</font>.outputBaseFilename = QtCore.QString('')<br>        <font color="green">self</font>.outputFilesFlag = False<br>        <font color="green">self</font>.displayProjectionsFlag = False<br>        <font color="green">self</font>.angleFileProvided = False<br>        <font color="green">self</font>.modelFilenameProvided = False<br>        <font color="green">self</font>.modelLoadedFlag = False<br>        <font color="green">self</font>.phi = 0<br>        <font color="green">self</font>.theta = 0<br>        <font color="green">self</font>.psi = 0<br><br><font color="green">if</font> __name__ == "<font color="green">__main__</font>":<br>    <font color="green">import</font> sys<br><br>    # Startup the application<br>    app = QtGui.QApplication(sys.argv)<br>    # app.setStyle('plastique')<br>    app.setStyle('mac')<br><br>    # Create the GUI<br>    GENFIRE_ProjectionCalculator = ProjectionCalculator()<br><br>    # Render the GUI<br>    GENFIRE_ProjectionCalculator.show()<br><br>    sys.exit(app.exec_())<br><br></code></body>
    </html>